<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title></title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.49.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.49.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<div id='map'></div>
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiZmVvbWlrZSIsImEiOiJNRjJrRmRnIn0.Sc8mxXKYTRfgegc_3vjZiw';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/feomike/cj0zcunxh000m2sqb2epkabb4',
    zoom: 12,
    center: [-97.35,35.12]  
});

var cable_url = 'mapbox://feomike.9gtha189' 
var cable_source_layer = 'mb_snob_f2_cable-d2cq5g' 

var pole_angle_url = 'mapbox://feomike.1h0zkpvh'
var pole_angle_source_layer = 'mb_snob_f2_pole_angle-4d0lzz'
// var consumers_url = 'mapbox://feomike.dgs9bdp7'
// var consumers_source_layer = 'mb_snob_f2_consumers-5t4spr'

// var splice_can_url = 'mapbox://feomike.8guh4md5'
// var splice_can_source_layer = 'mb_snob_f2_splice_can-2j4g4p'

var substat_url = 'mapbox://feomike.1kvj2ejd'
var substat_source_layer = 'mb_snob_f2_substations-ayjgxi'  

var tap_url = 'mapbox://feomike.dvpikcfe' 
var tap_source_layer = 'mb_snob_f2_tap_geo-3seyot' 

var myBlue = '#0000FF'
var myOrange = '#FFA500'
var myGreen = '#008000'
var myBrown = '#894444'
var mySlate = '#808080'
var myWhite = '#FFFFFF'
var myRed = '#FF0000'
var myBlack = '#000000'
var myYellow = '#FFFF00'
var myViolet = '#EE82EE'
var myRose = '#FFC0CB'
var myAqua = '#00FFFF'
var spanColor = '#800080'
var tapColor = '#bababa'//'#c4c4c4'
var spanAerial = '#551a8b' //purple
var spanUnder = '#FFA500'
var seqColor = '#A9A9A9' //'#FFA500'
var strandTextColor = '#545454' //'#FFA500'
var strandLineColor = '#dcdcdc' //'#FFA500'

//remember shapefile fields need to be upper case for mapbox to recognize them
//cable-96
map.on('load', function () {
     map.addLayer({
         //CABLE
         'id': 'cable-96',
         'type': 'line',
         'source': {
             type: 'vector', 
             url: cable_url
            },
         'source-layer': cable_source_layer,
         'filter': ['==', 'CABLE', 96],
         'layout':{'line-join':'round','line-cap':'round'},
         'paint': {
              'line-width': {
                base: 1,
                stops: [[10,1],[11,8],[12,9],[13,10],[14,11],[15,12],[16,13]]
              },
              'line-color': strandLineColor 
            }
     }); 
 });

//remember shapefile fields need to be upper case for mapbox to recognize them
//cable-48
map.on('load', function () {
     map.addLayer({
         //CABLE
         'id': 'cable-48',
         'type': 'line',
         'source': {
             type: 'vector', 
             url: cable_url
            },
         'source-layer': cable_source_layer,
         'filter': ['==', 'CABLE', 48],
         'paint': {
              'line-width': {
                base: 1,
                stops: [[10,1],[11,5],[12,6],[13,7],[14,8],[15,9],[16,10]]
              },
              'line-color': strandLineColor
                 }
     }); 
 });

//remember shapefile fields need to be upper case for mapbox to recognize them
//cable-24
map.on('load', function () {
     map.addLayer({
         //CABLE
         'id': 'cable-24',
         'type': 'line',
         'source': {
             type: 'vector', 
             url: cable_url
            },
         'source-layer': cable_source_layer,
         'filter': ['==', 'CABLE', 24],
         'paint': {
              'line-width': {
                base: 1,
                stops: [[10,1],[11,3],[12,4],[13,5],[14,6],[15,7],[16,8]]
              },
              'line-color': strandLineColor
                 }
     }); 
 });

//remember shapefile fields need to be upper case for mapbox to recognize them
//cable-12
map.on('load', function () {
     map.addLayer({
         //CABLE
         'id': 'cable-12',
         'type': 'line',
         'source': {
             type: 'vector', 
             url: cable_url
            },
         'source-layer': cable_source_layer,
         'filter': ['==', 'CABLE', 12],
         'paint': {
              'line-width': {
                base: 1,
                stops: [[10,1],[11,2],[12,3],[13,4],[14,5],[15,6],[16,7]]
              },
              'line-color': strandLineColor
                 }
     }); 
 });

//remember shapefile fields need to be upper case for mapbox to recognize them
//cable-4
map.on('load', function () {
     map.addLayer({
         //CABLE
         'id': 'cable-4',
         'type': 'line',
         'source': {
             type: 'vector', 
             url: cable_url
            },
         'source-layer': cable_source_layer,
         'filter': ['==', 'CABLE', 4],
         'paint': {
              'line-width': {
                base: 1,
                stops: [[10,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6]]
              },
              'line-color': strandLineColor
                 }
     }); 
 });

//remember shapefile fields need to be upper case for mapbox to recognize them
//cable
map.on('load', function () {
     map.addLayer({
         //CABLE
         'id': 'cable',
         'type': 'line',
         'source': {
             type: 'vector', 
             url: cable_url
            },
         'source-layer': cable_source_layer,
         'paint': {
              'line-width': 1,
              'line-color': 
                {
                property: 'STYPE',
                type: 'categorical',
                stops: [ ['1',spanAerial],
                     ['2', spanAerial],
                     ['3', spanUnder],
                     ['4', spanUnder]
                     ] } }
     }); 
 });

//Substation - these are squares
map.on('load', function () {
    map.addLayer(
    {//SUBSTATION
        'id': 'substation',
        'type': 'symbol',
        'source': {
            type: 'vector', 
            url: substat_url
            },
        'source-layer': substat_source_layer,
        'layout': {
            'visibility': 'visible',
            'icon-image': 'black-square-15',
            'icon-size':{
                 'base': .5,
                 'stops': [[12, .75], [13,1.25], [14,1.75], [15,2.25], [16,3.75] ]} 
                }
     }
     ); 
});


//
//
//modelled after Substation 
//pole-angle

map.on('load', function () {
    map.addLayer(
    {//pole_angle
        'id': 'pole-angle-all',
        'type': 'symbol',
        'source': {
            type: 'vector', 
            url: pole_angle_url
            },
        'source-layer': pole_angle_source_layer,
        'layout': {
            'visibility': 'visible',
            'icon-image': 'blue-circle-11',
            'icon-size':{
                 'base': .1,
                 'stops': [[12, .25], [13,.45], [14,.65], [15,.85], [16,1.05] ]} 
                }
     }
     ); 
});

//
//

//pole-angle-text - loss
map.on('load', function () {
     map.addLayer({
        //pole-angle
        'id': 'pole-angle-all-text',
        'type': 'symbol',
        'source': {
            type: 'vector', 
            url: pole_angle_url, //tap_url, //
            },
        'source-layer': pole_angle_source_layer, //tap_source_layer, //
        'paint': {
            'text-color': myBlue
            },
        'layout': {
            'text-field':'{angle}', //angle
            'text-font': ["Open Sans Semibold", "Arial Unicode MS Bold"],
            // 'symbol-placement': 'line',
            'text-offset': [0.8, 0.8],
            'text-size': {
                'base': 6, 
                'stops': [[12, 11], [13,12], [14,13], [15,14], [16,16] ]}
            }
     }); 
 });



</script>

</body>
</html>
